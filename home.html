<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aurora Point | Home</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: #E1E1E1; color: #333; display: flex; flex-direction: column; align-items: center; }

        .top-bar { 
            background: #003366; color: white; padding: 12px 20px; width: 100%; 
            display: flex; justify-content: space-between; align-items: center; 
            border-bottom: 4px solid #002244; box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .user-stats { font-size: 13px; font-weight: bold; text-align: right; }
        .stat-line { color: #FFD700; font-size: 14px; }
        /* Brilho neon suave para os Tixs */
        #user-tix { color: #00f2ff; text-shadow: 0 0 5px rgba(0,242,255,0.5); }

        .container { padding: 25px; display: flex; flex-direction: column; align-items: center; gap: 20px; width: 100%; }
        
        .card { background: white; border: 1px solid #CCC; padding: 15px; border-radius: 12px; width: 100%; max-width: 320px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .card img { width: 100%; border-radius: 8px; margin-bottom: 12px; border: 1px solid #EEE; }
        .card-title { display: block; font-weight: bold; margin-bottom: 8px; color: #003366; font-size: 20px; }
        
        .btn-play { width: 100%; background: #008000; color: white; border: none; padding: 14px; font-weight: bold; border-radius: 8px; cursor: pointer; box-shadow: 0 4px #005500; text-transform: uppercase; margin-bottom: 10px; }
        .btn-blue { width: 100%; background: #003366; color: white; border: none; padding: 14px; font-weight: bold; border-radius: 8px; cursor: pointer; box-shadow: 0 4px #001a33; text-transform: uppercase; margin-top: 10px; }
        
        .btn-logout { background: none; border: none; color: #CC0000; font-size: 13px; cursor: pointer; margin-top: 20px; font-weight: bold; text-decoration: underline; }
    </style>
</head>
<body>

    <header class="top-bar">
        <img src="https://i.postimg.cc/jScG67Yr/Design-sem-nome(1).png" width="70">
        <div class="user-stats">
            <div id="display-name" style="font-size: 15px; margin-bottom: 4px;">Ol√°, Jogador</div>
            <div class="stat-line">üéüÔ∏è <span id="user-tix">0</span> | ‚≠ê <span id="user-points">0</span></div>
        </div>
    </header>

    <div class="container">
        <div class="card">
            <img src="https://art.ngfiles.com/comments/739000/iu_739223_7577476.webp">
            <span class="card-title">Classic Crossroads</span>
            <button class="btn-play" onclick="location.href='online.html'">JOGAR NO SERVIDOR</button>
        </div>

        <div class="card">
            <span class="card-title">Menu do Jogador</span>
            <button class="btn-blue" onclick="location.href='catalog.html'">CAT√ÅLOGO & AVATAR</button>
        </div>

        <button class="btn-logout" onclick="logout()">Sair da Conta</button>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBvwC0_9DREMFIHFelYuc5RdfXz6bpo1JA",
            authDomain: "aurorapoint-a8a1e.firebaseapp.com",
            projectId: "aurorapoint-a8a1e",
            storageBucket: "aurorapoint-a8a1e.firebasestorage.app",
            messagingSenderId: "324340380415",
            appId: "1:324340380415:web:468fcca5188b539682d2ca"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        auth.onAuthStateChanged(user => {
            if (!user) { 
                window.location.href = 'index.html'; 
            } else {
                const userRef = db.collection("users").doc(user.uid);

                // LISTENER EM TEMPO REAL (onSnapshot)
                // Isso faz com que os Tixs aumentem na tela assim que o servidor liberar
                userRef.onSnapshot((doc) => {
                    if (doc.exists) {
                        const data = doc.data();
                        document.getElementById('display-name').innerText = "Ol√°, " + (data.username || "Jogador");
                        document.getElementById('user-tix').innerText = data.tixs || 0; // Nome corrigido para tixs
                        document.getElementById('user-points').innerText = data.points || 0;
                    }
                }, error => {
                    console.error("Erro ao escutar mudan√ßas:", error);
                });
            }
        });

        function logout() { 
            auth.signOut().then(() => { window.location.href = 'index.html'; });
        }
    </script>
</body>
</html>
